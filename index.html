<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ジャンケン 結果表示</title>
  <style>
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
      padding: 5px;
    }
  </style>
</head>
<body>
  <h1>ジャンケンしよう！</h1>

  <p>あなたの手を選んでね：</p>
  <button onclick="play('グー')">グー</button>
  <button onclick="play('チョキ')">チョキ</button>
  <button onclick="play('パー')">パー</button>

  <h2 id="result"></h2>

  <h3>結果一覧</h3>
  <table>
    <thead>
      <tr>
        <th>あなたの手</th>
        <th>コンピュータの手</th>
        <th>勝敗</th>
      </tr>
    </thead>
    <tbody id="resultTable">
      <!-- ここに結果を追加 -->
    </tbody>
  </table>

  <script>
    function play(userChoice) {
      const choices = ['グー', 'チョキ', 'パー'];
      const computerChoice = choices[Math.floor(Math.random() * 3)];

      let outcome = '';
      if (userChoice === computerChoice) {
        outcome = 'あいこ';
      } else if (
        (userChoice === 'グー' && computerChoice === 'チョキ') ||
        (userChoice === 'チョキ' && computerChoice === 'パー') ||
        (userChoice === 'パー' && computerChoice === 'グー')
      ) {
        outcome = '勝ち';
      } else {
        outcome = '負け';
      }

      // 最新の結果表示
      document.getElementById('result').textContent =
        `あなた: ${userChoice}  |  コンピュータ: ${computerChoice} → ${outcome}`;

      // 結果一覧に追加
      const table = document.getElementById('resultTable');
      const newRow = document.createElement('tr');
      newRow.innerHTML = `<td>${userChoice}</td><td>${computerChoice}</td><td>${outcome}</td>`;
      table.appendChild(newRow);

      // ローカルストレージに保存
      let history = JSON.parse(localStorage.getItem('history') || '[]');
      history.push({user: userChoice, computer: computerChoice, outcome: outcome});
      localStorage.setItem('history', JSON.stringify(history));
    }

    // ページを開いた時に履歴を復元
    window.onload = function() {
      let history = JSON.parse(localStorage.getItem('history') || '[]');
      const table = document.getElementById('resultTable');
      history.forEach(entry => {
        const newRow = document.createElement('tr');
        newRow.innerHTML = `<td>${entry.user}</td><td>${entry.computer}</td><td>${entry.outcome}</td>`;
        table.appendChild(newRow);
      });
    };
  </script>
</body>
</html>
